<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Price plans using SQLite</title>


    <script defer src="https://unpkg.com/alpinejs"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <link rel="stylesheet" href="./style.css">
    <script src="./alpineData.js"></script>

</head>

<body x-data="functions" x-cloak x-init="loadPricePlans()">




    <h1>Phone bill calculator using SQLite</h1>

    <div class="allPlans">
        <h2 class="subHeadings">Codex price plans</h2>
        <table class="pricePlanTable">

            <thead>
                <tr class="tableRow">
                    <th class="tableHeader">Plan name</th>
                    <th class="tableHeader">SMS cost</th>
                    <th class="tableHeader">Call cost</th>
                    <th class="tableHeader">Data cost</th>
                    <th>Edit/Delete</th>
                </tr>
            </thead>


            <tbody>
                <template x-for="plan in   priceData" :key="plan.id">

                    <tr class="tableRow">
                        <td class="tableData" x-text="plan.plan_name"></td>
                        <td class="tableData" x-text="plan.sms_price"></td>
                        <td class="tableData" x-text="plan.call_price"></td>
                        <td class="tableData" x-text="plan.data_price"></td>
                        <td class="tableData">
                            <button class="" @click="selectedPlanName = plan.plan_name" x-on:click="">
                                <ion-icon style="font-size: 15px; font-weight: bolder;"
                                    name="create-outline"></ion-icon>
                            </button>



                            <button @click="selectedPlanName = plan.plan_name" x-on:click="">
                                <ion-icon style="font-size: 15px; font-weight: bolder;" name="trash-outline"></ion-icon>
                            </button>
                        </td>
                    </tr>
                </template>
                <tr style="text-align: center;">
                    <td colspan="6"> <button class="addIcon"><ion-icon name="add-circle-outline"
                                @click="addPlan()"></ion-icon> </button></td>
                </tr>
                <tr x-show="!searchPopUp || !searched" style="text-align: center;">
                    <td colspan="6">
                        <button @click="searchPopUp = true">
                            <ion-icon name="search-circle-outline"></ion-icon>
                        </button>

                    </td>

                </tr>


                <tr x-show="searched" style="text-align: center;">
                    <td colspan="6" style="background-color: rgb(23, 23, 23); color: aliceblue;">SELECTED PLAN</td>
                </tr>
                <tr x-show="searched">
                    <td class="tableData" x-text="selectedPriceData.plan_name"></td>
                    <td class="tableData" x-text="selectedPriceData.sms_price"></td>
                    <td class="tableData" x-text="selectedPriceData.call_price"></td>
                    <td class="tableData" x-text="selectedPriceData.data_price"></td>
                    <td class="tableData">  <button @click="searchPopUp = true">
                        <ion-icon name="search-circle-outline"></ion-icon>
                    </button> </td>
                </tr>

            </tbody>
        </table>

    </div>


    <div class="phoneBill">
        <h2>Calculate costs</h2>

        <div>
            <label for="planName">Enter price plan name here:</label>
            <input class="phoneBillInputs" id="planName" x-model="selectedPlanName" type="text" :disabled="calculated">
        </div>

        <div>
            <label for="usage">Enter usage here</label>
            <input id="usage" class="phoneBillInputs" x-model="usage" type="text" :disabled="calculated">
        </div>

        <div>
            <label for="airtime">Enter airtime here</label>
            <input class="phoneBillInputs" type="number" x-model="airtime" id="airtime" :disabled="calculated">
        </div>

        <Button @click="calculateAirtime(); calculateTotalBill(); calculated = true " :disabled="calculated">Calculate</Button>

        <div x-show="calculated" x-text="'Total cost: ' + totalBill.totalBill">

        </div>

        <div x-show="calculated" x-text="'Remaining airtime: ' + remainingAirtime.totalBill">

        </div>

        <Button x-show="calculated" @click="calculated = false ">Calculate again</Button>

    </div>



    <div class="searchPopUp" x-show="searchPopUp">
        <h2 class="subHeadings">Search for a price plan </h2>

        <div style="text-align: center;">
            <input class="searchInputs" id="searchPlanInput" type="text" x-model="selectedPlanName"
                placeholder="Enter plan name here">
        </div>

        <div style="text-align: center;">
            <button class="searchButton" @click="loadSearchedPlan(); searchPopUp = false; searched = true">Search</button>
        </div>

        <button class="searchButton" @click="searchPopUp = false">Cancel</button>

    </div>



    <div class="popUp">
        <label for="searchInput"></label>

    </div>


</body>

</html>